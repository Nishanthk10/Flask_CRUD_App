{% extends 'base.html' %}
{% block title %} Product Page {% endblock %}
{% block body %}
<div class="jumbotron p-3">
    <div class="well text-center">
        <h1>Product Page</h1>
    </div>
</div>
<div class="container">
    <div class="row" style="background:lightgrey;">
        <div class="col md-12">

            <div class="jumbotron p-3">
                <h2>Manage <b>Products</b> <button type="button" class="btn btn-success float-end" data-bs-toggle="modal" data-bs-target="#mymodal">Add New Product</button></h2>

                {% with messages = get_flashed_messages() %}
                {% if messages %}
                {% for message in messages %}
                <div class="alert alert-success alert-dismissable" role="alert">
                    <button type="button" style="border: #fff; background: #d1e7dd;" class="float-end" data-bs-dismiss="alert" aria-label="close">x</button>
                    {{message}}
                </div>
                {% endfor %}
                {% endif %}
                {% endwith %}


                <table class="table table-hover table-dark" style="font-size: 14px;">
                    <tr>
                        <th>Product ID</th>
                        <th>Product Name</th>
                        <th>Supplier ID</th>
                        <th>Category ID</th>
                        <th>Quantity Type Per Unit</th>
                        <th>Unit Price</th>
                        <th>Units in Stock</th>
                        <th>Units on Order</th>
                        <th>Reorder Level</th>
                        <th>Discontinued</th>
                        <th style="padding-right: 91px;">Actions</th>
                    </tr>
                    {% for row in products %}
                    <tr style="font-size: 12px;">
                        <td>{{row.productid}}</td>
                        <td>{{row.productname}}</td>
                        <td>{{row.supplierid}}</td>
                        <td>{{row.categoryid}}</td>
                        <td>{{row.quantityperunit}}</td>
                        <td>{{row.unitprice}}</td>
                        <td>{{row.unitsinstock}}</td>
                        <td>{{row.unitsonorder}}</td>
                        <td>{{row.reorderlevel}}</td>
                        <td>{{row.discontinued}}</td>
                        <td>
                            <a href="/products/update/{{row.productid}}" class="btn btn-warning btn-xs" data-bs-toggle="modal" data-bs-target="#modaledit{{row.productid}}">Edit</a>
                            <a href="/products/delete/{{row.productid}}" class="btn btn-danger btn-xs" onclick="return confirm('Are You Sure To Delete?')">Delete</a>
                        </td> 
                    </tr>
                    <!-- Modal Edit Product-->
            <div id="modaledit{{row.productid}}" class="modal fade" role="dialog">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h4 class="modal-title">Update Information</h4>
                        </div>
                        <div class="modal-body">
                            <form action="{{url_for('updateproduct')}}" method="POST">
                                <div class="form-group">
                                    <label>Product Name:</label>
                                    <input type="hidden" name="productid" value="{{row.productid}}">  
                                    <input type="text" class="form-control" name="productname" value="{{row.productname}}">
                                </div>
                                <div class="form-group">
                                    <label>Supplier ID:</label> 
                                    <input type="number" class="form-control" name="supplierid" value="{{row.supplierid}}">
                                </div>
                                <div class="form-group">
                                    <label>Category ID:</label> 
                                    <input type="number" class="form-control" name="categoryid" value="{{row.categoryid}}">
                                </div>
                                <div class="form-group">
                                    <label>Quantity Per Unit:</label> 
                                    <input type="text" class="form-control" name="quantityperunit" value="{{row.quantityperunit}}">
                                </div>
                                <div class="form-group">
                                    <label>Unit Price:</label> 
                                    <input type="number" class="form-control" name="unitprice" value="{{row.unitprice}}">
                                </div>
                                <div class="form-group">
                                    <label>Units in Stock:</label> 
                                    <input type="number" class="form-control" name="unitsinstock" value="{{row.unitsinstock}}">
                                </div>
                                <div class="form-group">
                                    <label>Units on Order:</label> 
                                    <input type="number" class="form-control" name="unitsonorder" value="{{row.unitsonorder}}">
                                </div>
                                <div class="form-group">
                                    <label>Reorder Level:</label> 
                                    <input type="number" class="form-control" name="reorderlevel" value="{{row.reorderlevel}}">
                                </div>
                                <div class="form-group">
                                    <label>Discontinued:</label> 
                                    <input type="number" class="form-control" name="discontinued" value="{{row.discontinued}}">&nbsp;
                                </div>
                                <div class="form-group">
                                    <button class="btn btn-primary" type="submit">Update</button>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
                {% endfor %}
                </table>
            </div>
            <!-- Modal Add Product-->
            <div id="mymodal" class="modal fade" role="dialog">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h4 class="modal-title">Add Product</h4>
                        </div>
                        <div class="modal-body">
                            <form action="{{url_for('insertproduct')}}" method="POST">
                                <div class="form-group">
                                    <label>Product ID:</label>
                                    <input type="number" class="form-control" name="productid" required="1">
                                </div>
                                <div class="form-group">
                                    <label>Product Name:</label>
                                    <input type="text" class="form-control" name="productname" required="1">
                                </div>
                                <div class="form-group">
                                    <label>Supplier ID:</label> 
                                    <input type="number" class="form-control" name="supplierid" required="1">
                                </div>
                                <div class="form-group">
                                    <label>Category ID:</label> 
                                    <input type="number" class="form-control" name="categoryid" required="1">
                                </div>
                                <div class="form-group">
                                    <label>Quantity Per Unit:</label> 
                                    <input type="text" class="form-control" name="quantityperunit" required="1">
                                </div>
                                <div class="form-group">
                                    <label>Unit Price:</label> 
                                    <input type="number" class="form-control" name="unitprice" required="1">
                                </div>
                                <div class="form-group">
                                    <label>Units in Stock:</label> 
                                    <input type="number" class="form-control" name="unitsinstock" required="1">
                                </div>
                                <div class="form-group">
                                    <label>Units on Order:</label> 
                                    <input type="number" class="form-control" name="unitsonorder" required="1">
                                </div>
                                <div class="form-group">
                                    <label>Reorder Level:</label> 
                                    <input type="number" class="form-control" name="reorderlevel" required="1">
                                </div>
                                <div class="form-group">
                                    <label>Discontinued:</label> 
                                    <input type="number" class="form-control" name="discontinued" required="1">&nbsp;
                                </div>
                                <div class="form-group">
                                    <button class="btn btn-primary" type="submit">Add Product</button>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}